/*! Thrive Architect - 2020-12-10
* http://www.thrivethemes.com/
* Copyright (c) 2020 Thrive Themes */

!function(e){var t={isGutenbergActive:function(){return"undefined"!=typeof wp&&void 0!==wp.blocks},init:function(){var n=this;this.$gutenberg=e("#editor"),this.$architectNotificationContent=e("#thrive-gutenberg-switch").html(),this.$architectDisplay=e('<div id="tar-display">').append(this.$architectNotificationContent),this.$architectLauncher=this.$architectDisplay.find("#thrive_preview_button"),this.isPostBox=-1!==this.$architectNotificationContent.indexOf("postbox"),e(window).on("storage.tcb",function(t){var i,e=wp.data.select("core/editor").getCurrentPost();try{i=JSON.parse(t.originalEvent.newValue)}catch(t){}i&&i.ID&&"tve_post_options_change"===t.originalEvent.key&&i.ID===Number(e.id)&&window.location.reload()}),wp.data.subscribe(function(){var t=wp.data.select("core/editor");if(t){var i=t.isSavingPost(),e=t.isAutosavingPost();if(i&&!e){var o=JSON.stringify(t.getCurrentPost());window.localStorage.setItem("tve_post_options_change",o)}}setTimeout(function(){n.render()},1)})},render:function(){var t=this,i=!1;this.isPostBox?e("#tar-display").length||(this.$gutenberg.find(".editor-post-title").append(this.$architectDisplay),this.$gutenberg.find(".editor-block-list__layout,.block-editor-block-list__layout").hide(),this.$gutenberg.find(".editor-post-title__block").css("margin-bottom","0"),this.$gutenberg.find(".editor-writing-flow__click-redirect,.block-editor-writing-flow__click-redirect").hide(),this.$gutenberg.find(".edit-post-header-toolbar").css("visibility","hidden"),i=!0):e("#thrive_preview_button").length||(this.$gutenberg.find(".edit-post-header-toolbar").append(this.$architectLauncher),this.$architectLauncher.on("click",function(){t.$gutenberg.find(".editor-block-list__layout").hide()}),this.$gutenberg.find(".edit-post-header-toolbar").css("visibility","visible"),i=!0),i&&this.bindEvents()},bindEvents:function(){var i=this;e("#tcb2-show-wp-editor").on("click",function(){var t=i.$gutenberg.find(".tcb-enable-editor").closest(".postbox");e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{_nonce:TCB_Post_Edit_Data.admin_nonce,post_id:this.getAttribute("data-id"),action:"tcb_admin_ajax_controller",route:"disable_tcb"}}).done(function(t){}),t.next(".tcb-flags").find("input").prop("disabled",!1),t.remove(),i.$gutenberg.find(".editor-block-list__layout,.block-editor-block-list__layout").show(),i.isPostBox=!1,i.render()}),this.$architectLauncher.on("click",function(){e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{_nonce:TCB_Post_Edit_Data.admin_nonce,post_id:this.getAttribute("data-id"),action:"tcb_admin_ajax_controller",route:"change_post_status_gutenberg"}})})}};e(function(){t.isGutenbergActive()&&t.init(),window.addEventListener("load",function(){e(".tcb-revert").on("click",function(){confirm("Are you sure you want to DELETE all of the content that was created in this landing page and revert to the theme page? \n If you click OK, any custom content you added to the landing page will be deleted.")&&(location.href=location.href+"&tve_revert_theme=1",e("#editor").find(".edit-post-header-toolbar").css("visibility","visible"))})})})}(jQuery);